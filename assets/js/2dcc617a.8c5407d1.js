"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1131],{9061:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>p,toc:()=>d});var a=n(7462),o=(n(7294),n(3905)),i=n(2225);const l={},s="Behavior",p={unversionedId:"config/behavior",id:"version-20.x/config/behavior",title:"Behavior",description:"If you need to tweak the flow of detox.init() or detox.cleanup() steps,",source:"@site/versioned_docs/version-20.x/config/behavior.mdx",sourceDirName:"config",slug:"/config/behavior",permalink:"/Detox/docs/config/behavior",draft:!1,editUrl:"https://github.com/wix/Detox/edit/master/docs/versioned_docs/version-20.x/config/behavior.mdx",tags:[],version:"20.x",frontMatter:{},sidebar:"apiSidebar",previous:{title:"Artifacts",permalink:"/Detox/docs/config/artifacts"},next:{title:"Logger",permalink:"/Detox/docs/config/logger"}},r={},d=[{value:"Location",id:"location",level:2},{value:"Default values",id:"default-values",level:2},{value:"Properties",id:"properties",level:2},{value:"<code>behavior.init.reinstallApp</code> [boolean]",id:"behaviorinitreinstallapp-boolean",level:3},{value:"<code>behavior.init.exposeGlobals</code> [boolean]",id:"behaviorinitexposeglobals-boolean",level:3},{value:"<code>behavior.init.keepLockFile</code> [boolean]",id:"behaviorinitkeeplockfile-boolean",level:3},{value:"<code>behavior.launchApp</code> [enum]",id:"behaviorlaunchapp-enum",level:3},{value:"<code>behavior.cleanup.shutdownDevice</code> [boolean]",id:"behaviorcleanupshutdowndevice-boolean",level:3}],u={toc:d},c="wrapper";function h(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"behavior"},"Behavior"),(0,o.kt)("p",null,"If you need to tweak the flow of ",(0,o.kt)("inlineCode",{parentName:"p"},"detox.init()")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"detox.cleanup()")," steps,\nyou have a few options to change. These are the default behavior values:"),(0,o.kt)("h2",{id:"location"},"Location"),(0,o.kt)(i.ZP,{sectionName:"behavior",mdxType:"Location"}),(0,o.kt)("h2",{id:"default-values"},"Default values"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "behavior": {\n    "init": {\n      "reinstallApp": true,\n      "exposeGlobals": true,\n      "keepLockFile": false\n    },\n    "launchApp": "auto",\n    "cleanup": {\n      "shutdownDevice": false\n    }\n  }\n}\n')),(0,o.kt)("h2",{id:"properties"},"Properties"),(0,o.kt)("h3",{id:"behaviorinitreinstallapp-boolean"},(0,o.kt)("inlineCode",{parentName:"h3"},"behavior.init.reinstallApp")," ","[","boolean]"),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,o.kt)("p",null,"When ",(0,o.kt)("em",{parentName:"p"},"true"),", Detox will uninstall and install the app upon the initialization."),(0,o.kt)("p",null,"Setting it to ",(0,o.kt)("em",{parentName:"p"},"false")," forces the tests to use the previously installed app on the device,\nprovided you have installed it beforehand ",(0,o.kt)("a",{parentName:"p",href:"/Detox/docs/api/device#deviceinstallapp"},"explicitly")," or manually."),(0,o.kt)("h3",{id:"behaviorinitexposeglobals-boolean"},(0,o.kt)("inlineCode",{parentName:"h3"},"behavior.init.exposeGlobals")," ","[","boolean]"),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,o.kt)("p",null,"When ",(0,o.kt)("em",{parentName:"p"},"true"),", it forces Detox to expose ",(0,o.kt)("inlineCode",{parentName:"p"},"device"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"expect"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"element"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"by")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"waitFor"),"\nas global variables."),(0,o.kt)("p",null,"When ",(0,o.kt)("em",{parentName:"p"},"false"),", you should import them explicitly instead:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { by, device, expect, element } = require('detox');\n")),(0,o.kt)("p",null,"or, in TypeScript:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { by, device, expect, element } from 'detox';\n")),(0,o.kt)("h3",{id:"behaviorinitkeeplockfile-boolean"},(0,o.kt)("inlineCode",{parentName:"h3"},"behavior.init.keepLockFile")," ","[","boolean]"),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,o.kt)("p",null,"When ",(0,o.kt)("em",{parentName:"p"},"false"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"detox test")," command always deletes the shared lock file on start,\nassuming it had been left from the previous, already finished test session. The lock file\ncontains information about busy and free devices and ensures no device can be used\nsimultaneously by multiple test workers."),(0,o.kt)("p",null,"Setting it to ",(0,o.kt)("em",{parentName:"p"},"true")," might be useful when if you need to run multiple ",(0,o.kt)("inlineCode",{parentName:"p"},"detox test")," commands\nin parallel, e.g. test a few configurations at once with a simple Bash script:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"detox reset-lock-file & \\\ndetox test -c iphone.release & \\\ndetox test -c ipad.release & \\\ndetox test -c android.phone.release & \\\ndetox test -c android.tablet.release & \\\nwait;\n")),(0,o.kt)("admonition",{title:"Known issue",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"You can't run multiple ",(0,o.kt)("inlineCode",{parentName:"p"},"detox test \u2026")," commands simultaneously with ",(0,o.kt)("inlineCode",{parentName:"p"},"android.genycloud")," (Genymotion SaaS)\ndevices due to ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/wix/Detox/issues/3573"},"a known issue"),". We'll get on this as soon as\nwe can.")),(0,o.kt)("h3",{id:"behaviorlaunchapp-enum"},(0,o.kt)("inlineCode",{parentName:"h3"},"behavior.launchApp")," ","[","enum]"),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"auto"),"."),(0,o.kt)("p",null,"Possible values: ",(0,o.kt)("inlineCode",{parentName:"p"},"auto"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"manual"),"."),(0,o.kt)("p",null,"When set to ",(0,o.kt)("inlineCode",{parentName:"p"},"manual"),", Detox won't be launching your app automatically. Instead, it will\nbe waiting until you launch it manually from IDE and press any key to resume the test\nexecution. This is useful when you want to ",(0,o.kt)("a",{parentName:"p",href:"/Detox/docs/introduction/debugging"},"debug the native codebase")," when running Detox tests."),(0,o.kt)("p",null,"Also, setting it to ",(0,o.kt)("inlineCode",{parentName:"p"},"manual")," resets ",(0,o.kt)("inlineCode",{parentName:"p"},"behavior.reinstallApp")," to ",(0,o.kt)("em",{parentName:"p"},"false"),"."),(0,o.kt)("h3",{id:"behaviorcleanupshutdowndevice-boolean"},(0,o.kt)("inlineCode",{parentName:"h3"},"behavior.cleanup.shutdownDevice")," ","[","boolean]"),(0,o.kt)("p",null,"Default: ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,o.kt)("p",null,"When set to ",(0,o.kt)("em",{parentName:"p"},"true"),", Detox will shut down the device after the tests finish."),(0,o.kt)("admonition",{title:"Known issue",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Currently Detox shuts down the device after completing every test file, and that makes the test session unnecessarily long\nand inefficient. This is ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/wix/Detox/issues/2894"},"a known issue")," and we plan to fix it as soon\nas we can.")))}h.isMDXComponent=!0},2225:(e,t,n)=>{n.d(t,{ZP:()=>p});var a=n(7462),o=(n(7294),n(3905)),i=n(814);const l={toc:[]},s="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(s,(0,a.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"You can define the ",(0,o.kt)("code",null,n.sectionName)," config section in two ways: ",(0,o.kt)("i",null,"globally")," and ",(0,o.kt)("i",null,"locally")," (per a configuration):"),(0,o.kt)(i.Z,{title:".detoxrc.js",language:"javascript",mdxType:"CodeBlock"},["/** @type {Detox.DetoxConfig} */","module.exports = {","// highlight-start",`  ${n.sectionName}: {`,"    /* global section */","  },","// highlight-end","  devices: { /* \u2026 */ },","  apps: { /* \u2026 */ },","  configurations: {","    'ios.sim.debug': {","      device: 'iphone',","      app: 'ios.debug',","// highlight-start",`      ${n.sectionName}: {`,"        /* local (per-configuration) section */","      },","// highlight-end","    },","  },","};"].join("\n")))}p.isMDXComponent=!0}}]);